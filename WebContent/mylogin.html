<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="420409134995-9pai2dr3clt5cs03u6e6i6o2vjaeer96.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>   
	<script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
	
	<!--Loading Animation code CSS & JS Links  -->
    <link href="css/animation.css" type="text/css" rel="stylesheet">
    <script src="js/jquery.js"></script>
    <script src="js/jquery.backstretch.js"></script>
	<script src="js/animation.js"></script>
	<!--Loading Animation code CSS & JS Links ends here  -->
	
    <title>Login Page</title>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-1.11.3.min.js"></script>
    
	<!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/myindex.css" rel="stylesheet">
	<link href="css/login.css" rel="stylesheet">
	<link href='http://fonts.googleapis.com/css?family=Happy+Monkey' rel='stylesheet' type='text/css'>
	
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  
  <body onload="start()">
  <div id="loader">
	</div>
	<div id="main">	
		
		<nav class="navbar navbar-default" id="header">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar1">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>                        
					</button>
					<a href="index.html" class="navbar-brand" id="icon"><b>frrndLease</b></a>
				</div>
				<div class="collapse navbar-collapse" id="myNavbar1">
					<ul class="nav navbar-nav navbar-right" id="navbar1right">
						
						
						<li class="dropdown" id="subheader">
							<a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
							<span id="salutation"></span> <span class="caret"></span></a>
							
							<ul class="dropdown-menu">
								<li><a href="mypostings.html"><span class="glyphicon glyphicon-phone"></span> MyPostings </a></li>
								<li role="separator" class="divider"></li>
								<li><a href="mywishlists.html"><span class="glyphicon glyphicon-heart-empty"></span> MyWishList </a></li>
								<li role="separator" class="divider"></li>
								<li><a href="myincomingrequests.html"><span class="glyphicon glyphicon-inbox"></span> MyIncomingRequests </a></li>
								<li role="separator" class="divider"></li>
								<li><a href="myleasedoutitems.html"><span class="glyphicon glyphicon-gift"></span> MyLeasedOutItems </a></li>
								<li role="separator" class="divider"></li>
								<li><a href="myleasedinitems.html"><span class="glyphicon glyphicon-shopping-cart"></span> MyLeasedInItems </a></li>
								<li role="separator" class="divider"></li>
								<li><a href="myfriendslist.html"><span class="glyphicon glyphicon-user"></span> MyFriends </a></li>
								<li role="separator" class="divider"></li>
								<li id="logoutoptionmenu"><a href="#"><span class="glyphicon glyphicon-log-out"></span> Logout </a></li>
							</ul>
						</li>
						
					</ul>
				</div>
			</div>
		</nav>	
		
		<div class="container">
			<div class="g-signin2" data-onsuccess="onSignIn"></div>			<!--Google login button-->
			<br/>
		
			<form class="form-signin" id="loginform">
				<h2 class="form-signin-heading">Please Log in</h2>
				
				<input type="email" id="email" class="form-control" placeholder="Email address" required autofocus><br />
				<input type="password" id="password" class="form-control" placeholder="Password" required><br />
				
				<span id="newuser">
				New User? <a href="mysignup.html" id="signup">Signup</a>
				</span>
				<br /><br />
				<button class="btn btn-lg btn-primary btn-block" type="submit">Log in</button>
			</form>
			<br />
			<!--Form ends here-->
			<!--Displaying error of the form-->
			<div id="error_row">
				<div class="col-md-12 col-sm-12 col-xs-12">
					<div class="alert alert-danger fade in" id="errormsg">
						<a href="#" class="close" data-dismiss="alert">&times;</a>
						<strong>Error!</strong> 
					</div>
				</div>
			</div>	
		</div> <!-- /container -->
		
		<!-- Button trigger Alert Modal -->
		<button id="alertModalTriggerButton" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myAlertModal">
		  Launch demo modal
		</button>

		<!-- Alert Modal -->
		<div class="modal fade" id="myAlertModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<!--<h4 class="modal-title" id="myModalLabel">-->
				
				</h4>
			  </div>
			  <div class="modal-body" id="alertModalMsg">
				
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal" onclick="continueWork()">Yes</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">No</button>
			  </div>
			</div>
		  </div>
		</div>
		
		<!-- Button trigger Confirmation Modal -->
		<button id="modalTriggerButton" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
		  Launch demo modal
		</button>

		<!-- Confirmation Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
			<div class="modal-content">
			  <div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">
				
				</h4>
			  </div>
			  <div class="modal-body" id="modalMsg">
				
			  </div>
			  <div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal" onclick="redirectToPrevPage()">Close</button>
			  </div>
			</div>
		  </div>
		</div>
	
		
		<!--Footer starts------------------------------------>
		<nav class="navbar navbar-default navbar-fixed-bottom">
			<div class="container-fluid">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbarBottom">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>                        
				</button>
				<div class="collapse navbar-collapse" id="myNavbarBottom">
					<ul class="nav navbar-nav navbar-center">
						<li><a href="https://www.facebook.com/frrndlease"><span class="glyphicon glyphicon-th-large"></span> About</a></li>
						<li><a href="https://www.facebook.com/frrndlease"><span class="glyphicon glyphicon-pencil"></span> Blog</a></li>
						<li><a href="myhowitworks.html"><span class="glyphicon glyphicon-road"></span> How It Works</a></li>
						<li><a href="mycredits.html"><span class="glyphicon glyphicon-certificate"></span> Credits</a></li>
						<li><a href="https://www.facebook.com/frrndlease"><span class="glyphicon glyphicon-earphone"></span> Contact</a></li>
					</ul>
				</div>
			</div>
		</nav>
		
	</div>
	
	
	<script type="text/javascript">
		var loginemail, loginpassword;
		
		function start(){
			$("#modalTriggerButton").hide();
			$("#alertModalTriggerButton").hide();
			
			$('#subheader').css("display","none");		//if logged in as anonymous then don't display subheader, else show the subheader
		
			$('#error_row').hide();
		}
		
		
		$("#loginform").submit(function(event){
			event.preventDefault();
			
			var error_row = document.getElementById("error_row");
			error_row.innerHTML = '';
			$('#error_row').css("display", "none");						//just to hide the error on re-submission of the form
			
			//get information filled in the form
			
			loginemail = $("#email").val();
			loginpassword = $("#password").val();
			
			loginDbCreate();
		
		});

		//google login starts here--------------------------------------------------	
		function onSignIn(googleUser) {
		
			var profile = googleUser.getBasicProfile();
			loginpassword = profile.getId();
			loginemail =  profile.getEmail();
			
			// The ID token you need to pass to your backend:
			//var id_token = googleUser.getAuthResponse().id_token;
			
			loginDbCreate();	//this function is in the script_admin_v2.js
		};
		//google login ends here---------------------------------------------
		
		function loginSuccessful(obj){
			localStorage.setItem("userloggedin", obj.userId);				//set the "name" of the user who is loggedin
			//localStorage.setItem("userLocation", obj.location);
			
			var msg = 1;
			
			confirmationIndex(msg);
		}
		
		function loginUnsuccessful(str){
			var msg = -1;
			
			confirmationIndex(msg);
			
		}
		
		function confirmationIndex(msg){			//called from script_admin_v2.js
			if(msg == -1){
				setPrevPage("mylogin.html");
				
				var heading = document.getElementById("myModalLabel");
				heading.innerHTML = "Login Failed";
				
				var div = document.getElementById("modalMsg");
				div.innerHTML = "Incorrect username or password";
			}else{
				setPrevPage("index.html");
				
				var heading = document.getElementById("myModalLabel");
				heading.innerHTML = "Login Successful";
				
				var div = document.getElementById("modalMsg");
				div.innerHTML = "Welcome back to fRRndLease";
			}
			
			$("#modalTriggerButton").click();
		}
		
		function redirectToPrevPage(){
			prevPage = getPrevPage();
			
			if(prevPage != "mylogin.html"){
				window.location.replace(prevPage);
			}
		}
		
		function redirectToHomePage(){
			window.location.replace("index.html");
		}
	</script>
    
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="js/index.js"></script>
	<script type="text/javascript" src="js/script_admin_v2.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>