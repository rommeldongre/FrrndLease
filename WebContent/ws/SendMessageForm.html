<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Send Message Form</title>
<script type="text/javascript" src="../js/jquery-1.7.min.js"></script>
<script type="text/javascript">
	var AccessToken = null;
	var UserId = null;
	var FriendId= null;
	var FriendName= null;
	var Message = null;
	var ItemId= 0;
	var ItemName = null;
	var ItemUid = null;
	
	start = function(){
        document.getElementById("accessToken").value = localStorage.getItem("userloggedinAccess");
		AccessToken = document.getElementById("accessToken").value;
    }
	
	getData = function() {
		UserId = document.getElementById("userId").value;
		FriendId = document.getElementById("friendId").value;
		FriendName = document.getElementById("friendName").value;
		Message = document.getElementById("message").value;
		ItemId = document.getElementById("itemId").value;
		if(ItemId == null || ItemId==""){
			ItemId=0;
		}
		
		ItemName = document.getElementById("itemName").value;
		if(ItemName==null || ItemName==""){
			ItemName=null;
		}
		
		ItemUid = document.getElementById("itemUid").value;
		if(ItemUid==null || ItemUid==""){
			ItemUid=null;
		}
	}
	
	sendMessage = function() {
		
		getData();
		
		var req = {
			userId : UserId,
			message: Message,
			friendId: FriendId,
			friendName: FriendName,
			itemName: ItemName,
			itemUid : ItemUid,
			itemId : itemId,
			accessToken: AccessToken
		};
		
		console.log(req);
		send(req);
	};
	
	send = function(req) {
		alert("Inside send");
		$.ajax({
			url: '/SendMessage',
			type: 'post',
			data: JSON.stringify(req),
			contentType: "application/x-www-form-urlencoded",
			dataType: "json",
			success: function(response) {
				document.getElementById("Code").value = response.code;
				document.getElementById("Message").value = response.message;
			},
		
			error: function() {
				alert('Not Working');
			}
		});
	};
	
</script>
</head>
<body onload="start()">
<h1> Send Message FORM</h1>
	<form>
		<p>Fill in the below details to send your friend Message </p>
		User Id(*) : <input type="text" name="userId" id="userId"><br /><br />
		Friend Id(*) : <input type="text" name="friendId" id="friendId"><br /><br />
		Friend Name : <input type="text" name="friendName" id="friendName"><br /><br />
		Item Name : <input type="text" name="itemName" id="itemName"><br /><br />
		Item Id : <input type="text" name="itemId" id="itemId"><br /><br />
		Item UID : <input type="text" name="itemUid" id="itemUid"><br /><br />
		Message(*) : <input type="text" name="message" id="message"><br /><br />
		<br /> Access Token: <input type="text" name="accessToken" id="accessToken" ><br/><br />
		<input type="button" value="Send Message" onclick="sendMessage()">
		
		<h1>OUTPUT</h1>
		Code : <input type="text" name="code" id="Code"><br/><br/>
		Message : <input type="text" name="message" id="Message">
	</form>
	<br/>
	<h3><A href="index.html">INDEX</A></h3>
</body>
</html>